\documentclass[paper=a4, fontsize=11pt]{scrartcl} % A4 paper and 11pt font size
\usepackage[T1]{fontenc} % Use 8-bit encoding that has 256 glyphs
\usepackage{fourier} % Use the Adobe Utopia font for the document - comment this line to return to the LaTeX default
\usepackage[english]{babel} % English language/hyphenation
\usepackage{amsmath,amsfonts,amsthm} % Math packages
\usepackage{graphicx} % Embedding graphics in document
\usepackage{caption}
\usepackage{listings}
% Custom code listing
\usepackage{color}
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}
\lstdefinestyle{mystyle}{
  backgroundcolor=\color{backcolour},
  commentstyle=\color{codegreen},
  keywordstyle=\color{magenta},
  numberstyle=\tiny\color{codegray},
  stringstyle=\color{codepurple},
  basicstyle=\footnotesize,
  breakatwhitespace=false,
  breaklines=true,
  captionpos=b,
  keepspaces=true,
  numbers=left,
  numbersep=5pt,
  showspaces=false,
  showstringspaces=false,
  showtabs=false,
  tabsize=2
}
\lstset{style=mystyle}
% End of custom code listing
\usepackage[utf8]{inputenc}
\usepackage{lipsum} % Used for inserting dummy 'Lorem ipsum' text into the template
\usepackage{sectsty} % Allows customizing section commands
\allsectionsfont{\centering \normalfont\scshape} % Make all sections centered, the default font and small caps
\usepackage{fancyhdr} % Custom headers and footers
\pagestyle{fancyplain} % Makes all pages in the document conform to the custom headers and footers
\fancyhead{} % No page header - if you want one, create it in the same way as the footers below
\fancyfoot[L]{} % Empty left footer
\fancyfoot[C]{} % Empty center footer
\fancyfoot[R]{\thepage} % Page numbering for right footer
\renewcommand{\headrulewidth}{0pt} % Remove header underlines
\renewcommand{\footrulewidth}{0pt} % Remove footer underlines
\setlength{\headheight}{13.6pt} % Customize the height of the header
\numberwithin{equation}{section} % Number equations within sections (i.e. 1.1, 1.2, 2.1, 2.2 instead of 1, 2, 3, 4)
\numberwithin{figure}{section} % Number figures within sections (i.e. 1.1, 1.2, 2.1, 2.2 instead of 1, 2, 3, 4)
\numberwithin{table}{section} % Number tables within sections (i.e. 1.1, 1.2, 2.1, 2.2 instead of 1, 2, 3, 4)
\setlength\parindent{0pt} % Removes all indentation from paragraphs - comment this line for an assignment with lots of text
\theoremstyle{definition}
\newtheorem*{definition}{Definition}
% Theorems
%----------------------------------------------------------------------------------------
% TITLE SECTION
%----------------------------------------------------------------------------------------
\newcommand{\horrule}[1]{\rule{\linewidth}{#1}} % Create horizontal rule command with 1 argument of height
\title{	
  \normalfont \normalsize
  \textsc{University of Oslo} \\ [25pt] % Your university, school and/or department name(s)
  \horrule{0.5pt} \\[0.4cm] % Thin top horizontal rule
  \huge MAT1120 - Assignment 2 \\ % The assignment title
  \horrule{2pt} \\[0.5cm] % Thick bottom horizontal rule
}
\author{Ivar Haugal√∏kken Stangeby} % Your name
\date{\normalsize\today} % Today's date or a custom date
\begin{document}
\maketitle % Print the title
\section*{Problem 1}
Assume that $U = \left[ \mathbf{u}_1,\dots,\mathbf{u}_n \right]$ is an $\left(n \times n\right)$-matrix.
Verify that $U$ is \textbf{\textit{semi-orthogonal}} if and only if $\mathbf{u}_j \neq \mathbf{0}$ for $j=1,\dots,n$ and all the $\mathbf{u}_j$'s are orthogonal
to each other. In other words, $\mathbf{u}_j \cdot \mathbf{u}_j = 0$ when $j \neq i$.

\begin{definition}
  A quadratic matrix $U$ is called \textbf{semi-orthogonal} if $U^TU$ is a \textbf{diagonal} matrix with only positive entries along the
  main diagonal.
\end{definition}
\begin{definition}
	A matrix $U$ is called \textbf{diagonal} if $U$ has non-zero entries only along the
	main diagonal.
\end{defintition}

We now want to show that the condition is both sufficient and neccessary for the matrix to be \textbf{\textit{semi-orthogonal}}.

Let us first form the matrix $B = U^TU$.
\begin{align*}
  B = \begin{pmatrix}
	\mathbf{u}_1 \\
	\vdots \\
	\mathbf{u}_n\\
  \end{pmatrix} \begin{bmatrix}
	\mathbf{u}_1 & \hdots & \mathbf{u}_n\\
  \end{bmatrix} = \begin{bmatrix}
	\mathbf{u}_1 \cdot \mathbf{u}_1 & \hdots & \mathbf{u}_1\cdot\mathbf{u}_n \\
	\vdots & \ddots & \vdots \\
	\mathbf{u}_n \cdot \mathbf{u}_1 & \hdots & \mathbf{u}_n\cdot\mathbf{u}_n\\
  \end{bmatrix}.
\end{align*}
Assume now that each column in $U$ is orthogonal to all the other columns. We can then directly see that all the entries in $B$ that are not
along the main diagonal must be zero. It is now sufficient to show that the entries along the main diagonal must be strictly positive.
Let $\mathbf{u} \in U$ be an arbitrary vector from $U$.
\begin{align*}
  \mathbf{u}\cdot\mathbf{u} = u_1^2 + \dots + u_n^2.
\end{align*}
Each term is squared, thus $\mathbf{u}\cdot\mathbf{u}$ is strictly positive.

If we instead were to assume that each column in $U$ was \textbf{not} orthogonal to the other columns, we can directly from the matrix $B$ see that we get
non-zero entries that are not along the main diagonal, which contradict the condition that $B$ must be a diagonal matrix.
We can then conclude that $U$ is \textbf{\textit{semi-orthogonal}} if and only if the columns of $U$ are orthogonal, and not the zero vector.

Further assume that $U$ is \textbf{\textit{semi-orthogonal}} and let
\begin{align*}
  \mathbf{u}_j' = \frac{1}{\mathbf{u}_j\cdot\mathbf{u}_j}\mathbf{u}_j, \qquad j = 1,\dots,n.
\end{align*}
Argue that $U$ is invertible and that
\begin{align*}
  U^{-1} = \left[ \mathbf{u}_1' \dots \mathbf{u}_n' \right]^T.
\end{align*}
Let us look at the columns of $U, \left\{ \mathbf{u}_1,\dots,\mathbf{u}_n \right\}$.
If the set of columns is an orthogonal set of non-zero vectors then the set is linearly independent.
Since we assumed that $U$ is \textit{\textbf{semi-orthogonal}}, then it follows that the set of columns is linearly independent.\\
By the \underline{Invertible Matrix Theorem}, $U$ is invertible.

We now want to show that the inverse of $U$ is as given above.
Let us check if $UU^{-1} = I$.
\begin{align*}
  UU^{-1} = \begin{bmatrix}
	\mathbf{u}_1 & \hdots & \mathbf{u}_n
  \end{bmatrix} \begin{pmatrix}
	\mathbf{u}_1'\\
	\vdots\\
	\mathbf{u}_n'\\
  \end{pmatrix} = \begin{bmatrix}
	\mathbf{u}_1\cdot\mathbf{u}_1' & \hdots & \mathbf{u}_1\cdot\mathbf{u}_n'\\
	\vdots & \ddots & \vdots \\
	\mathbf{u}_n\cdot\mathbf{u}_1' & \hdots & \mathbf{u}_n\cdot\mathbf{u}_n'\\
  \end{bmatrix}
\end{align*}
Let $\mathbf{x}, \mathbf{y}' \in \left\{ \mathbf{u}_1, \dots, \mathbf{u}_n \right\}$.\\
\begin{itemize}
  \item $\mathbf{x} = \mathbf{y} \Rightarrow \mathbf{x}\cdot\mathbf{y}' = 1$
  \item $\mathbf{x} \neq \mathbf{y} \Rightarrow \mathbf{x}\cdot\mathbf{y}' = 0$
\end{itemize}
We have that $\mathbf{x} = \mathbf{y}$ only along the main diagonal, therefore $UU^{-1} = I$.

\section*{Problem 2}
Divide $\left[ 0, \pi \right]$ into 3 intervals of length $\frac{\pi}{3}$ and let $t_1, t_2$ and $t_3$ be the midpoints of these intervals.
Let
\begin{align*}
  % 3x3
C_3 =  
  \begin{bmatrix}
   1 & \cos (t_1) & \cos (2t_1) \\
   1 & \cos (t_2) & \cos (2t_2) \\
   1 & \cos (t_3) & \cos (2t_3) \\
  \end{bmatrix} & \qquad S_3 = 
  \begin{bmatrix}
   \sin (t_1) & \sin (2t_1) & \sin (3t_1) \\
   \sin (t_2) & \sin (2t_2) & \sin (3t_2) \\
   \sin (t_3) & \sin (2t_3) & \sin (3t_3) \\
  \end{bmatrix}
\end{align*}
Plugging in the values of $t_1, t_2$ and $t_3$ gives: 
\begin{align*}
  C_3 = 
  \begin{bmatrix}
  1 & \frac{\sqrt{3}}{2} & \frac{1}{2}\\
  1 & 0 & -1 \\
  1 & -\frac{\sqrt{3}}{2} & \frac{1}{2} \\
\end{bmatrix} & \qquad S_3 = 
\begin{bmatrix}
  \frac{1}{2} & \frac{\sqrt{3}}{2} & 1 \\
  1 & 0 & -1 \\
  \frac{1}{2} & -\frac{\sqrt{3}}{2} & 1\\
\end{bmatrix}
\end{align*}

These two matrices are \textit{\textbf{semi-orthogonal}} because $C_3^TC_3$ and $S_3^TS_3$ are diagonal matrices with only positive entries along the main diagonal.
\begin{align*}
  C_3^TC_3 = \begin{bmatrix}
	3 & 0 & 0 \\
	0 & \frac{3}{2} & 0 \\
	0 & 0 & \frac{3}{2}\\
  \end{bmatrix} \qquad S_3^TS_3 =
  \begin{bmatrix}
	\frac{3}{2} & 0 & 0 \\
	0 & \frac{3}{2} & 0 \\
	0 & 0 & 3\\
  \end{bmatrix}
\end{align*}
Based on this we know that the inverses of these matrices are given by $U^{-1} = \begin{bmatrix}
  \mathbf{u}_1' & \dots & \mathbf{u}_n'
\end{bmatrix}^T$
This gives us the inverses:
\begin{align*}
  C_3^{-1} = 
 \begin{bmatrix}
   \frac{1}{3} & \frac{1}{3} & \frac{1}{3} \\
   \frac{\sqrt{3}}{3} & 0 &  -\frac{\sqrt{3}}{3} \\
   \frac{1}{3} & -\frac{2}{3} & \frac{1}{3}\\
 \end{bmatrix} \qquad & S_3^{-1} = 
 \begin{bmatrix}
   \frac{1}{3} & \frac{2}{3} & \frac{1}{3}\\
   \frac{\sqrt{3}}{3} & 0 & -\frac{\sqrt{3}}{3}\\
   \frac{1}{3} & -\frac{1}{3} & \frac{1}{3}\\
 \end{bmatrix}
\end{align*}
\end{document}
